{"ast":null,"code":"import \"antd/es/card/style\";\nimport _Card from \"antd/es/card\";\nimport \"antd/es/table/style\";\nimport _Table from \"antd/es/table\";\nimport \"antd/es/icon/style\";\nimport _Icon from \"antd/es/icon\";\nimport \"antd/es/input/style\";\nimport _Input from \"antd/es/input\";\nimport \"antd/es/message/style\";\nimport _message from \"antd/es/message\";\nimport \"antd/es/button/style\";\nimport _Button from \"antd/es/button\";\nimport \"antd/es/select/style\";\nimport _Select from \"antd/es/select\";\nvar _jsxFileName = \"/Users/ao/WebstormProjects/react-management/src/view/product/home.jsx\";\nimport React, { Component } from 'react';\nimport LinkButton from '../../components/link-button/button';\nimport { reqProduct, reqSearchProduct, reqUpdateStatus } from '../../api/index';\nimport { PAGE_SIZE } from '../../utils/contains';\nconst Option = _Select.Option;\nexport default class Home extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      total: 0,\n      product: [],\n      searchType: 'productName',\n      searchName: ''\n    };\n\n    this.initColunms = () => {\n      this.columns = [{\n        title: '商品名称',\n        dataIndex: 'name'\n      }, {\n        title: '商品描述',\n        dataIndex: 'desc'\n      }, {\n        title: '价格',\n        dataIndex: 'price',\n        render: price => '¥' + price //\n\n      }, {\n        width: 100,\n        title: '状态',\n        align: 'center',\n        render: product => {\n          const status = product.status,\n                _id = product._id;\n          const newStatus = status === 1 ? 2 : 1;\n          return React.createElement(\"span\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 38\n            },\n            __self: this\n          }, React.createElement(_Button, {\n            type: \"primary\",\n            onClick: () => this.updateStatus(newStatus, _id),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 39\n            },\n            __self: this\n          }, status == 1 ? '下架' : '上架'), React.createElement(\"span\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 45\n            },\n            __self: this\n          }, status == 1 ? '在售' : '待售'));\n        }\n      }, {\n        width: 100,\n        title: '操作',\n        align: 'center',\n        render: product => {\n          return React.createElement(\"span\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 56\n            },\n            __self: this\n          }, React.createElement(LinkButton, {\n            onClick: () => this.props.history.push('/product/detail', {\n              product\n            }),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 57\n            },\n            __self: this\n          }, \"\\u8BE6\\u60C5\"), React.createElement(LinkButton, {\n            onClick: () => this.props.history.push('/product/add', {\n              product\n            }),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 58\n            },\n            __self: this\n          }, \"\\u4FEE\\u6539\"));\n        }\n      }];\n    };\n\n    this.getProduct = async pageNum => {\n      const _this$state = this.state,\n            searchType = _this$state.searchType,\n            searchName = _this$state.searchName;\n      this.pageNum = pageNum;\n      let result;\n\n      if (searchName) {\n        result = await reqSearchProduct(pageNum, PAGE_SIZE, searchName, searchType);\n        console.log('123');\n      } else {\n        result = await reqProduct(pageNum, PAGE_SIZE);\n      }\n\n      if (result.status === 0) {\n        const _result$data = result.data,\n              list = _result$data.list,\n              total = _result$data.total;\n        this.setState({\n          product: list,\n          total\n        });\n      }\n    };\n\n    this.updateStatus = async (newStatus, productId) => {\n      const result = await reqUpdateStatus(productId, newStatus);\n\n      if (result.status == 0) {\n        _message.success('更新成功');\n\n        this.getProduct(this.pageNum);\n      }\n    };\n  }\n\n  componentWillMount() {}\n\n  componentDidMount() {\n    this.getProduct(1);\n  }\n\n  render() {\n    const _this$state2 = this.state,\n          product = _this$state2.product,\n          total = _this$state2.total,\n          searchType = _this$state2.searchType,\n          searchName = _this$state2.searchName;\n    const title = React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    }, React.createElement(_Select, {\n      value: searchType,\n      style: {\n        width: 150\n      },\n      onChange: value => this.setState({\n        searchType: value\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101\n      },\n      __self: this\n    }, React.createElement(Option, {\n      value: \"productName\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106\n      },\n      __self: this\n    }, \"\\u6309\\u540D\\u79F0\\u641C\\u7D22\"), React.createElement(Option, {\n      value: \"productDesc\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107\n      },\n      __self: this\n    }, \"\\u6309\\u63CF\\u8FF0\\u641C\\u7D22\")), React.createElement(_Input, {\n      placeholder: \"\\u5173\\u952E\\u5B57\",\n      style: {\n        width: 150,\n        margin: '0 15px'\n      },\n      value: searchName,\n      onChange: event => this.setState({\n        searchName: event.target.value\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    }), React.createElement(_Button, {\n      type: \"primary\",\n      onClick: () => this.getProduct(1),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115\n      },\n      __self: this\n    }, \"\\u641C\\u7D22\"));\n    const extra = React.createElement(_Button, {\n      type: \"primary\",\n      onClick: () => this.props.history.push('/product/add'),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120\n      },\n      __self: this\n    }, React.createElement(_Icon, {\n      type: \"plus\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121\n      },\n      __self: this\n    }), \"\\u6DFB\\u52A0\\u5546\\u54C1\");\n    this.initColunms();\n    return React.createElement(_Card, {\n      title: \"123\",\n      title: title,\n      extra: extra,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }, React.createElement(_Table, {\n      bordered: true,\n      rowKey: \"_id\",\n      dataSource: product,\n      columns: this.columns,\n      pagination: {\n        defaultPageSize: PAGE_SIZE,\n        showQuickJumper: true,\n        total,\n        onChange: page => this.getProduct(page)\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }));\n  }\n\n}","map":{"version":3,"sources":["/Users/ao/WebstormProjects/react-management/src/view/product/home.jsx"],"names":["React","Component","LinkButton","reqProduct","reqSearchProduct","reqUpdateStatus","PAGE_SIZE","Option","Home","state","total","product","searchType","searchName","initColunms","columns","title","dataIndex","render","price","width","align","status","_id","newStatus","updateStatus","props","history","push","getProduct","pageNum","result","console","log","data","list","setState","productId","success","componentWillMount","componentDidMount","value","margin","event","target","extra","defaultPageSize","showQuickJumper","onChange","page"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport {Card, Select, Input, Button, Icon, Table, message} from 'antd';\n\nimport LinkButton from '../../components/link-button/button';\nimport {reqProduct,reqSearchProduct,reqUpdateStatus} from '../../api/index';\nimport {PAGE_SIZE} from '../../utils/contains';\nconst Option=Select.Option;\nexport default class Home extends Component {\n  state={\n    total:0,\n    product:[],\n    searchType:'productName',\n    searchName:''\n  };\n  initColunms=()=>{\n    this.columns = [\n      {\n        title: '商品名称',\n        dataIndex: 'name',\n      },\n      {\n        title: '商品描述',\n        dataIndex: 'desc',\n      },\n      {\n        title: '价格',\n        dataIndex: 'price',\n        render: (price) => '¥' + price  //\n      },\n      {\n        width: 100,\n        title: '状态',\n        align:'center',\n        render: (product) => {\n          const {status,_id} = product;\n          const newStatus= status===1?2:1;\n          return (\n              <span>\n              <Button\n                  type='primary'\n                  onClick={()=>this.updateStatus(newStatus,_id)}\n              >\n                {status==1?'下架':'上架'}\n              </Button>\n              <span>{status==1?'在售':'待售'}</span>\n            </span>\n          )\n        }\n      },\n      {\n        width: 100,\n        title: '操作',\n        align:'center',\n        render: (product) => {\n          return (\n              <span>\n                <LinkButton onClick={()=>this.props.history.push('/product/detail',{product})}>详情</LinkButton>\n              <LinkButton onClick={()=>this.props.history.push('/product/add',{product})}>修改</LinkButton>\n            </span>\n          )\n        }\n      }\n    ]\n  };\n  getProduct=async (pageNum)=>{\n    const {searchType,searchName} =this.state;\n    this.pageNum=pageNum;\n    let result;\n    if(searchName){\n      result =await reqSearchProduct(pageNum,PAGE_SIZE,searchName,searchType);\n      console.log('123');\n    }else{\n      result=await reqProduct(pageNum,PAGE_SIZE)\n    }\n    if(result.status===0){\n      const {list,total}=result.data;\n      this.setState({\n        product:list,\n        total\n      })\n    }\n  };\n  updateStatus=async (newStatus,productId)=>{\n    const result = await reqUpdateStatus(productId,newStatus);\n    if(result.status==0){\n      message.success('更新成功');\n      this.getProduct(this.pageNum);\n    }\n  };\n  componentWillMount() {\n\n  };\n  componentDidMount() {\n    this.getProduct(1);\n  }\n\n  render() {\n    const {product,total,searchType,searchName}=this.state;\n    const title = (\n        <span>\n        <Select\n            value= {searchType}\n            style={{width: 150}}\n            onChange={value => this.setState({searchType: value})}\n        >\n          <Option value='productName'>按名称搜索</Option>\n          <Option value='productDesc'>按描述搜索</Option>\n        </Select>\n        <Input\n            placeholder='关键字'\n            style={{width: 150, margin: '0 15px'}}\n            value={searchName}\n            onChange={event => this.setState({searchName: event.target.value})}\n        />\n        <Button type='primary' onClick={()=>this.getProduct(1)} >搜索</Button>\n      </span>\n    );\n\n    const extra = (\n        <Button type='primary' onClick={()=>this.props.history.push('/product/add')} >\n          <Icon type='plus'/>\n          添加商品\n        </Button>\n    );\n    this.initColunms();\n    return (\n        <Card title='123' title={title} extra={extra}>\n          <Table\n              bordered\n              rowKey='_id'\n              dataSource={product}\n              columns={this.columns}\n              pagination={{\n                defaultPageSize:PAGE_SIZE,\n                showQuickJumper:true,\n                total,\n                onChange:page=>this.getProduct(page)\n              }}\n          />\n        </Card>\n    );\n  }\n}"]},"metadata":{},"sourceType":"module"}